{"ast":null,"code":"import _regeneratorRuntime from\"C:/wamp64/www/Projet_TER/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/wamp64/www/Projet_TER/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"C:/wamp64/www/Projet_TER/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"C:/wamp64/www/Projet_TER/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:/wamp64/www/Projet_TER/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useContext,useState}from'react';import Auth from\"../contexts/Auth\";import{login,isUserRole,isAdminRole,isSuperAdminRole}from\"../services/AuthApi\";import'font-awesome/css/font-awesome.min.css';import{isUser}from\"../services/AuthApi\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Login=function Login(_ref){var history=_ref.history;//Utilisation du contexte pour vérifier les états de connexion\nvar _useContext=useContext(Auth),setIsAuthenticated=_useContext.setIsAuthenticated,setUserRole=_useContext.setUserRole;var _useState=useState({username:\"\",mot_de_passe:\"\"}),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var handleChange=function handleChange(_ref2){var currentTarget=_ref2.currentTarget;var name=currentTarget.name,value=currentTarget.value;setUser(_objectSpread(_objectSpread({},user),{},_defineProperty({},name,value)));};var handleSubmit=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var response,userRole,_response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();//Set les états du contexte quand on est connecté\n_context.prev=1;_context.next=4;return login(user);case 4:response=_context.sent;setIsAuthenticated(response);userRole=isUser();if(userRole){setUserRole(userRole);}history.replace('/quiz');_context.next=15;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](1);_response=_context.t0.response;console.log(_response);case 15:case\"end\":return _context.stop();}}},_callee,null,[[1,11]]);}));return function handleSubmit(_x){return _ref3.apply(this,arguments);};}();var change=function change(_ref5){var currentTarget=_ref5.currentTarget;history.replace('/register');};//\n// useEffect(() => {\n//    // Redirection si déjà loggé et sur la page login\n//     if (isAuthenticated) {\n//         history.replace('/home')\n//     }\n//\n// }, [history, isAuthenticated]);\nreturn/*#__PURE__*/_jsx(\"div\",{className:\"LoginRegister\",children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Sign in\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"InputItems\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"input\",{className:\"inputIcon\",type:\"text\",id:\"username\",name:\"username\",required:true,placeholder:\"\\uF007    Username\",onChange:handleChange})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"input\",{className:\"inputIcon\",type:\"password\",id:\"password\",name:\"mot_de_passe\",required:true,placeholder:\"    Password\",onChange:handleChange})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"action\",children:/*#__PURE__*/_jsx(\"button\",{className:\"button filled\",onClick:handleSubmit,children:\"Sign in\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"signup\",children:/*#__PURE__*/_jsxs(\"p\",{children:[\"Don't have an account ? \",/*#__PURE__*/_jsx(\"a\",{onClick:change,children:\"Create one now\"})]})})]})});};export default Login;","map":{"version":3,"sources":["C:/wamp64/www/Projet_TER/src/views/Login.js"],"names":["React","useContext","useState","Auth","login","isUserRole","isAdminRole","isSuperAdminRole","isUser","Login","history","setIsAuthenticated","setUserRole","username","mot_de_passe","user","setUser","handleChange","currentTarget","name","value","handleSubmit","event","preventDefault","response","userRole","replace","console","log","change"],"mappings":"ysBAAA,MAAOA,CAAAA,KAAP,EAAeC,UAAf,CAA2BC,QAA3B,KAA0C,OAA1C,CACA,MAAOC,CAAAA,IAAP,KAAiB,kBAAjB,CACA,OAAQC,KAAR,CAAeC,UAAf,CAA2BC,WAA3B,CAAwCC,gBAAxC,KAA+D,qBAA/D,CACA,MAAO,uCAAP,CACA,OAAQC,MAAR,KAAqB,qBAArB,C,wFAEA,GAAMC,CAAAA,KAAK,CAAG,QAARA,CAAAA,KAAQ,MAAe,IAAbC,CAAAA,OAAa,MAAbA,OAAa,CAEzB;AACA,gBAA2CT,UAAU,CAACE,IAAD,CAArD,CAAOQ,kBAAP,aAAOA,kBAAP,CAA2BC,WAA3B,aAA2BA,WAA3B,CAEA,cAAwBV,QAAQ,CAAC,CAC7BW,QAAQ,CAAE,EADmB,CAE7BC,YAAY,CAAE,EAFe,CAAD,CAAhC,wCAAOC,IAAP,eAAaC,OAAb,eAKA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,OAAqB,IAAnBC,CAAAA,aAAmB,OAAnBA,aAAmB,CACtC,GAAOC,CAAAA,IAAP,CAAsBD,aAAtB,CAAOC,IAAP,CAAaC,KAAb,CAAsBF,aAAtB,CAAaE,KAAb,CACAJ,OAAO,gCAAKD,IAAL,wBAAYI,IAAZ,CAAmBC,KAAnB,GAAP,CACH,CAHD,CAKA,GAAMC,CAAAA,YAAY,2FAAG,iBAAMC,KAAN,kJACjBA,KAAK,CAACC,cAAN,GAEA;AAHiB,sCAKUnB,CAAAA,KAAK,CAACW,IAAD,CALf,QAKPS,QALO,eAMbb,kBAAkB,CAACa,QAAD,CAAlB,CACIC,QAPS,CAOEjB,MAAM,EAPR,CAQb,GAAGiB,QAAH,CAAY,CACRb,WAAW,CAACa,QAAD,CAAX,CACH,CACDf,OAAO,CAACgB,OAAR,CAAgB,OAAhB,EAXa,iFAYPF,SAZO,aAYPA,QAZO,CAabG,OAAO,CAACC,GAAR,CAAYJ,SAAZ,EAba,qEAAH,kBAAZH,CAAAA,YAAY,6CAAlB,CAkBA,GAAMQ,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,OAAqB,IAAnBX,CAAAA,aAAmB,OAAnBA,aAAmB,CAChCR,OAAO,CAACgB,OAAR,CAAgB,WAAhB,EACH,CAFD,CAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA,mBACI,YAAK,SAAS,CAAC,eAAf,uBACI,oCACI,+BADJ,cAEI,aAAK,SAAS,CAAC,YAAf,wBACI,kCACI,cAAO,SAAS,CAAE,WAAlB,CAA8B,IAAI,CAAC,MAAnC,CAA0C,EAAE,CAAC,UAA7C,CAAwD,IAAI,CAAC,UAA7D,CAAwE,QAAQ,KAAhF,CAAiF,WAAW,CAAC,oBAA7F,CACO,QAAQ,CAAET,YADjB,EADJ,EADJ,cAMI,kCACI,cAAO,SAAS,CAAE,WAAlB,CAA8B,IAAI,CAAC,UAAnC,CAA8C,EAAE,CAAC,UAAjD,CAA4D,IAAI,CAAC,cAAjE,CAAgF,QAAQ,KAAxF,CAAyF,WAAW,CAAE,eAAtG,CACO,QAAQ,CAAEA,YADjB,EADJ,EANJ,GAFJ,cAcI,YAAK,SAAS,CAAC,QAAf,uBACI,eAAQ,SAAS,CAAC,eAAlB,CAAkC,OAAO,CAAEI,YAA3C,qBADJ,EAdJ,cAkBI,YAAK,SAAS,CAAC,QAAf,uBACI,6DAA2B,UAAG,OAAO,CAAEQ,MAAZ,4BAA3B,GADJ,EAlBJ,GADJ,EADJ,CA0BH,CAxED,CA0EA,cAAepB,CAAAA,KAAf","sourcesContent":["import React, {useContext, useState} from 'react';\r\nimport Auth from \"../contexts/Auth\";\r\nimport {login, isUserRole, isAdminRole, isSuperAdminRole} from \"../services/AuthApi\";\r\nimport 'font-awesome/css/font-awesome.min.css';\r\nimport {isUser} from \"../services/AuthApi\";\r\n\r\nconst Login = ({history}) => {\r\n\r\n    //Utilisation du contexte pour vérifier les états de connexion\r\n    const {setIsAuthenticated, setUserRole } = useContext(Auth);\r\n\r\n    const [user, setUser] = useState({\r\n        username: \"\",\r\n        mot_de_passe: \"\"\r\n    });\r\n\r\n    const handleChange = ({currentTarget}) => {\r\n        const {name, value} = currentTarget;\r\n        setUser({...user, [name]: value})\r\n    }\r\n\r\n    const handleSubmit = async event => {\r\n        event.preventDefault();\r\n\r\n        //Set les états du contexte quand on est connecté\r\n        try {\r\n            const response = await login(user);\r\n            setIsAuthenticated(response);\r\n            let userRole = isUser();\r\n            if(userRole){\r\n                setUserRole(userRole)\r\n            }\r\n            history.replace('/quiz')\r\n        } catch ({response}) {\r\n            console.log(response);\r\n        }\r\n    }\r\n\r\n\r\n    const change = ({currentTarget}) => {\r\n        history.replace('/register')\r\n    }\r\n    //\r\n    // useEffect(() => {\r\n    //    // Redirection si déjà loggé et sur la page login\r\n    //     if (isAuthenticated) {\r\n    //         history.replace('/home')\r\n    //     }\r\n    //\r\n    // }, [history, isAuthenticated]);\r\n\r\n\r\n    return (\r\n        <div className=\"LoginRegister\">\r\n            <div>\r\n                <h3>Sign in</h3>\r\n                <div className=\"InputItems\">\r\n                    <div>\r\n                        <input className =\"inputIcon\" type=\"text\" id=\"username\" name=\"username\" required placeholder=\"    Username\"\r\n                               onChange={handleChange}/>\r\n                    </div>\r\n\r\n                    <div>\r\n                        <input className =\"inputIcon\" type=\"password\" id=\"password\" name=\"mot_de_passe\" required placeholder={\"    Password\"}\r\n                               onChange={handleChange}/>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"action\">\r\n                    <button className=\"button filled\" onClick={handleSubmit}>Sign in</button>\r\n                </div>\r\n\r\n                <div className=\"signup\">\r\n                    <p>Don't have an account ? <a onClick={change}>Create one now</a></p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Login;\r\n"]},"metadata":{},"sourceType":"module"}