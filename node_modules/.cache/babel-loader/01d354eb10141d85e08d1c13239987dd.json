{"ast":null,"code":"import axios from 'axios';\nimport jwtDecode from \"jwt-decode\";\nimport { getItem, addItem, removeItem } from \"./LocalStorage\";\nexport function hasAuthenticated() {\n  const token = getItem('miniblogToken');\n  const result = token ? tokenIsValid(token) : false;\n\n  if (false === result) {\n    removeItem('miniblogToken');\n  }\n\n  return result;\n}\nexport function login(credentials) {\n  let protocol = window.location.protocol;\n  let host = window.location.hostname;\n  let url = protocol + '//' + host;\n  return axios.post('http://localhost:80/Projet_TER/API/Controllers/connexion.php', credentials).then(response => response.data.token).then(token => {\n    addItem('miniblogToken', token);\n    return true;\n  });\n}\nexport function logout() {\n  removeItem('miniblogToken');\n}\n\nfunction tokenIsValid(token) {\n  const {\n    exp: expiration\n  } = jwtDecode(token);\n\n  if (expiration * 1000 > new Date().getTime()) {\n    return true;\n  }\n\n  return false;\n}","map":{"version":3,"sources":["C:/wamp64/www/Projet_TER/src/services/AuthApi.js"],"names":["axios","jwtDecode","getItem","addItem","removeItem","hasAuthenticated","token","result","tokenIsValid","login","credentials","protocol","window","location","host","hostname","url","post","then","response","data","logout","exp","expiration","Date","getTime"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,SAAQC,OAAR,EAAiBC,OAAjB,EAA0BC,UAA1B,QAA2C,gBAA3C;AAEA,OAAO,SAASC,gBAAT,GAA4B;AAC/B,QAAMC,KAAK,GAAGJ,OAAO,CAAC,eAAD,CAArB;AACA,QAAMK,MAAM,GAAGD,KAAK,GAAGE,YAAY,CAACF,KAAD,CAAf,GAAyB,KAA7C;;AAEA,MAAI,UAAUC,MAAd,EAAsB;AAClBH,IAAAA,UAAU,CAAC,eAAD,CAAV;AACH;;AAED,SAAOG,MAAP;AACH;AAID,OAAO,SAASE,KAAT,CAAeC,WAAf,EAA2B;AAC9B,MAAIC,QAAQ,GAAGC,MAAM,CAACC,QAAP,CAAgBF,QAA/B;AACA,MAAIG,IAAI,GAAGF,MAAM,CAACC,QAAP,CAAgBE,QAA3B;AACA,MAAIC,GAAG,GAAGL,QAAQ,GAAG,IAAX,GAAkBG,IAA5B;AACA,SAAOd,KAAK,CACPiB,IADE,CACG,8DADH,EACmEP,WADnE,EAEFQ,IAFE,CAEGC,QAAQ,IAAGA,QAAQ,CAACC,IAAT,CAAcd,KAF5B,EAGFY,IAHE,CAGGZ,KAAK,IAAG;AACVH,IAAAA,OAAO,CAAC,eAAD,EAAkBG,KAAlB,CAAP;AACA,WAAO,IAAP;AACH,GANE,CAAP;AAOH;AAED,OAAO,SAASe,MAAT,GAAkB;AACrBjB,EAAAA,UAAU,CAAC,eAAD,CAAV;AACH;;AAED,SAASI,YAAT,CAAsBF,KAAtB,EAA6B;AACzB,QAAM;AAAEgB,IAAAA,GAAG,EAAEC;AAAP,MAAsBtB,SAAS,CAACK,KAAD,CAArC;;AAEA,MAAIiB,UAAU,GAAG,IAAb,GAAoB,IAAIC,IAAJ,GAAWC,OAAX,EAAxB,EAA8C;AAC1C,WAAO,IAAP;AACH;;AAED,SAAO,KAAP;AACH","sourcesContent":["import axios from 'axios';\r\nimport jwtDecode from \"jwt-decode\";\r\nimport {getItem, addItem, removeItem} from \"./LocalStorage\";\r\n\r\nexport function hasAuthenticated() {\r\n    const token = getItem('miniblogToken');\r\n    const result = token ? tokenIsValid(token) : false;\r\n\r\n    if (false === result) {\r\n        removeItem('miniblogToken');\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n\r\n\r\nexport function login(credentials){\r\n    let protocol = window.location.protocol;\r\n    let host = window.location.hostname;\r\n    let url = protocol + '//' + host;\r\n    return axios\r\n        .post('http://localhost:80/Projet_TER/API/Controllers/connexion.php', credentials)\r\n        .then(response =>response.data.token)\r\n        .then(token =>{\r\n            addItem('miniblogToken', token);\r\n            return true;\r\n        });\r\n}\r\n\r\nexport function logout() {\r\n    removeItem('miniblogToken');\r\n}\r\n\r\nfunction tokenIsValid(token) {\r\n    const { exp: expiration } = jwtDecode(token);\r\n\r\n    if (expiration * 1000 > new Date().getTime()) {\r\n        return true;\r\n    }\r\n\r\n    return false;\r\n}\r\n"]},"metadata":{},"sourceType":"module"}