{"ast":null,"code":"import _slicedToArray from\"C:/wamp64/www/Projet_TER/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import Loader from\"../components/Loader\";import logo from\"../public/logothedre.png\";import{FontAwesomeIcon}from\"@fortawesome/react-fontawesome\";import{faPen}from\"@fortawesome/free-solid-svg-icons\";import ModalEditHome from\"../components/modal/ModalEditHome\";import React,{useContext,useEffect,useState}from\"react\";import Auth from\"../contexts/Auth\";import{useHistory}from'react-router-dom';import axios from\"axios\";/**\r\n * @Goal : Render home, open modal to edit description, call to api to edit\r\n * @UsedByModule : App.js\r\n * @ModuleUsed : Loader, ModalEditHome\r\n * @VisibleVariables :\r\n * @VisibleProcedures :\r\n * @returns {JSX.Element}\r\n */import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Home(){/**\r\n     * Setup state for role, description, newDescription, modalOpen\r\n     */var _useState=useState(null),_useState2=_slicedToArray(_useState,2),description=_useState2[0],setDescription=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),modalOpen=_useState4[0],setModalOpen=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),newDescription=_useState6[0],setNewDescription=_useState6[1];var _useContext=useContext(Auth),isAdmin=_useContext.isAdmin,isSuperAdmin=_useContext.isSuperAdmin;var history=useHistory();/**\r\n     * Call API to update description\r\n     */function getHomeContent(){var protocol=window.location.protocol;var host=window.location.hostname;var url=protocol+'//'+host;if(description===null){axios.get(url+'/API/Controllers/accueil/lire.php').then(function(response){setDescription(response.data['description']);}).catch(function(error){return console.log(error);});}}/**\r\n     * Effect before render\r\n     */useEffect(function(){getHomeContent();});/**\r\n     * Set boolean modalOpen to true\r\n     */function handleOpen(){setModalOpen(true);}/**\r\n     * Set boolean modalOpen to false\r\n     */function handleClose(){setModalOpen(false);}/**\r\n     * Update newDescription with param description\r\n     * @param description the new description\r\n     */function handleChange(description){setNewDescription(description);}/**\r\n     * Call to API to edit description\r\n     */function edit(){if(newDescription!==null){var data=JSON.stringify({description:newDescription});var protocol=window.location.protocol;var host=window.location.hostname;var url=protocol+'//'+host;axios.put(url+'/API/Controllers/accueil/modifier.php',data).then(function(){axios.get(url+'/API/Controllers/accueil/lire.php').then(function(response){setDescription(response.data['description']);}).catch(function(error){return console.log(error);});handleClose();}).catch(function(erreur){console.log(erreur);});}handleClose();}/**\r\n     * Redirect to quiz component\r\n     */var redirect=function redirect(){history.push('/quiz');};/**\r\n     * Return Loader if description is not set\r\n     */if(description===null)return/*#__PURE__*/_jsx(Loader,{});/**\r\n     * Return content if description is set, contains ModalEditHome\r\n     */else return/*#__PURE__*/_jsxs(\"div\",{className:\"Home\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"logo\",children:[/*#__PURE__*/_jsx(\"img\",{src:logo,alt:'Logo Thedre'}),/*#__PURE__*/_jsx(\"button\",{className:\"button filled\",onClick:redirect,children:\"Start\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"title\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Contents\"}),isAdmin&&/*#__PURE__*/_jsx(FontAwesomeIcon,{className:\"icon\",icon:faPen,onClick:handleOpen}),isSuperAdmin&&/*#__PURE__*/_jsx(FontAwesomeIcon,{className:\"icon\",icon:faPen,onClick:handleOpen})]}),/*#__PURE__*/_jsx(\"p\",{children:description}),/*#__PURE__*/_jsx(ModalEditHome,{title:\"Modify description\",message:\"Please modify\",oldDescription:description,actionButton:\"Confirm\",closeButton:\"Quit\",open:modalOpen,close:handleClose,mainAction:edit,changeAction:handleChange})]})]});}export default Home;","map":{"version":3,"sources":["C:/wamp64/www/Projet_TER/src/views/Home.js"],"names":["Loader","logo","FontAwesomeIcon","faPen","ModalEditHome","React","useContext","useEffect","useState","Auth","useHistory","axios","Home","description","setDescription","modalOpen","setModalOpen","newDescription","setNewDescription","isAdmin","isSuperAdmin","history","getHomeContent","protocol","window","location","host","hostname","url","get","then","response","data","catch","error","console","log","handleOpen","handleClose","handleChange","edit","JSON","stringify","put","erreur","redirect","push"],"mappings":"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","sourcesContent":["import Loader from \"../components/Loader\";\r\nimport logo from \"../public/logothedre.png\";\r\nimport {FontAwesomeIcon} from \"@fortawesome/react-fontawesome\";\r\nimport {faPen} from \"@fortawesome/free-solid-svg-icons\";\r\nimport ModalEditHome from \"../components/modal/ModalEditHome\";\r\nimport React, {useContext, useEffect, useState} from \"react\";\r\nimport Auth from \"../contexts/Auth\";\r\nimport { useHistory } from 'react-router-dom';\r\nimport axios from \"axios\";\r\n\r\n/**\r\n * @Goal : Render home, open modal to edit description, call to api to edit\r\n * @UsedByModule : App.js\r\n * @ModuleUsed : Loader, ModalEditHome\r\n * @VisibleVariables :\r\n * @VisibleProcedures :\r\n * @returns {JSX.Element}\r\n */\r\nfunction Home() {\r\n    /**\r\n     * Setup state for role, description, newDescription, modalOpen\r\n     */\r\n    const [description, setDescription] = useState(null);\r\n    const [modalOpen, setModalOpen] = useState(false);\r\n    const [newDescription, setNewDescription] = useState(null);\r\n    const {isAdmin, isSuperAdmin} = useContext(Auth);\r\n    const history = useHistory();\r\n\r\n    /**\r\n     * Call API to update description\r\n     */\r\n    function getHomeContent() {\r\n        let protocol = window.location.protocol;\r\n        let host = window.location.hostname;\r\n        let url = protocol + '//' + host;\r\n\r\n        if (description === null) {\r\n            axios.get(url + '/API/Controllers/accueil/lire.php')\r\n                .then(response => {\r\n                    setDescription(response.data['description']);\r\n                })\r\n                .catch(error => console.log(error))\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Effect before render\r\n     */\r\n    useEffect(() => {\r\n        getHomeContent();\r\n    });\r\n\r\n\r\n    /**\r\n     * Set boolean modalOpen to true\r\n     */\r\n    function handleOpen() {\r\n        setModalOpen(true);\r\n    }\r\n\r\n    /**\r\n     * Set boolean modalOpen to false\r\n     */\r\n    function handleClose() {\r\n        setModalOpen(false);\r\n    }\r\n\r\n    /**\r\n     * Update newDescription with param description\r\n     * @param description the new description\r\n     */\r\n    function handleChange(description) {\r\n        setNewDescription(description);\r\n    }\r\n\r\n    /**\r\n     * Call to API to edit description\r\n     */\r\n    function edit() {\r\n        if (newDescription !== null) {\r\n            let data = JSON.stringify({description: newDescription});\r\n            let protocol = window.location.protocol;\r\n            let host = window.location.hostname;\r\n            let url = protocol + '//' + host;\r\n            axios.put(url +'/API/Controllers/accueil/modifier.php',data)\r\n                .then(() => {\r\n                    axios.get(url+ '/API/Controllers/accueil/lire.php')\r\n                        .then(response => {\r\n                            setDescription(response.data['description']);\r\n                        })\r\n                        .catch(error => console.log(error))\r\n                    handleClose();\r\n                })\r\n                .catch(function (erreur) {\r\n                    console.log(erreur);\r\n                });\r\n        }\r\n        handleClose();\r\n    }\r\n\r\n    /**\r\n     * Redirect to quiz component\r\n     */\r\n    const redirect = () => {\r\n        history.push('/quiz')\r\n    }\r\n\r\n    /**\r\n     * Return Loader if description is not set\r\n     */\r\n    if (description === null) return (<Loader/>);\r\n    /**\r\n     * Return content if description is set, contains ModalEditHome\r\n     */\r\n    else return (\r\n        <div className=\"Home\">\r\n            <div className=\"logo\">\r\n                <img src={logo} alt={'Logo Thedre'}/>\r\n                <button className=\"button filled\" onClick={redirect}>Start</button>\r\n            </div>\r\n            <div className=\"content\">\r\n                <div className=\"title\">\r\n                    <h3>Contents</h3>\r\n                    {/*<FontAwesomeIcon className=\"icon\" icon={faPen} onClick={handleOpen}/>*/}\r\n                    {isAdmin  && ( <FontAwesomeIcon className=\"icon\" icon={faPen} onClick={handleOpen}/>)}\r\n                    {isSuperAdmin && ( <FontAwesomeIcon className=\"icon\" icon={faPen} onClick={handleOpen}/>)}\r\n                </div>\r\n\r\n                <p>{description}</p>\r\n                <ModalEditHome\r\n                    title=\"Modify description\"\r\n                    message=\"Please modify\"\r\n                    oldDescription={description}\r\n                    actionButton=\"Confirm\"\r\n                    closeButton=\"Quit\"\r\n                    open={modalOpen}\r\n                    close={handleClose}\r\n                    mainAction={edit}\r\n                    changeAction={handleChange}\r\n                />\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\nexport default Home;"]},"metadata":{},"sourceType":"module"}