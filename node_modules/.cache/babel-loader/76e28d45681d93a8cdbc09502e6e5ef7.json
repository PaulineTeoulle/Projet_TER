{"ast":null,"code":"var _jsxFileName = \"C:\\\\wamp64\\\\www\\\\Projet_TER\\\\src\\\\views\\\\FileUpload.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport $ from 'jquery';\nimport axios from 'axios';\nimport pdf from \"../public/pdf.svg\";\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faUpload, faTrash } from '@fortawesome/free-solid-svg-icons';\nimport ModalConfirmation from '../components/modal/ModalConfirmation';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction FileUpload(props) {\n  _s();\n\n  const [file, setFile] = useState(null);\n  const [allFiles, setAllFiles] = useState(null);\n\n  function onSubmit(e) {\n    e.preventDefault();\n    uploadFile(file);\n  }\n\n  function onChange(e) {\n    setFile(e.target.files[0]);\n  }\n\n  function uploadFile(file) {\n    const formData = new FormData();\n    formData.append('file', file);\n    let protocol = window.location.protocol;\n    let host = window.location.hostname;\n    let url = protocol + '//' + host;\n    axios.post(url + '/Projet_TER/API/Controllers/ressource/uploadFile.php', formData, {\n      headers: {\n        'content-type': 'multipart/form-data'\n      }\n    }).then(response => {\n      loadFiles();\n      setFile(null);\n    });\n  }\n\n  function openFile(name) {\n    let protocol = window.location.protocol;\n    let host = window.location.hostname;\n    let url = protocol + '//' + host;\n    window.open(url + '/Projet_TER/src/public/documentsRessources/' + name);\n  }\n\n  function deleteFile(id) {\n    let protocol = window.location.protocol;\n    let host = window.location.hostname;\n    let url = protocol + '//' + host;\n    let data = JSON.stringify({\n      id: Number(id)\n    });\n    console.log(data);\n    axios({\n      method: 'delete',\n      url: url + '/Projet_TER/API/Controllers/ressource/supprimerRessource.php',\n      data: data\n    }).then(response => loadFiles());\n  }\n\n  function loadFiles() {\n    let protocol = window.location.protocol;\n    let host = window.location.hostname;\n    let url = protocol + '//' + host;\n    axios.get(url + '/Projet_TER/API/Controllers/ressource/lire.php').then(response => {\n      setAllFiles(response.data.ressources);\n    });\n  }\n\n  useEffect(() => {\n    if (file) {\n      $(\"form>label\").html(file.name);\n      $(\"form>label\").css(\"color\", \"black\");\n    } else {\n      $(\"form>label\").html(\"Choose file...\");\n      $(\"form>label\").css(\"color\", \"lightgray\");\n    }\n  }, [file]);\n  useEffect(() => {\n    if (!allFiles) {\n      loadFiles();\n    }\n  }, []); // Modal management\n\n  const [modalOpen, setModalOpen] = useState(false);\n  const [message, setMessage] = useState(null);\n  const [selectedElement, setSelectedElement] = useState(null);\n\n  function openModal(element) {\n    setModalOpen(true);\n    setMessage(\"Do you want to delete \" + element.Nom + \" ?\");\n    setSelectedElement(element.ID_Ressource);\n  }\n\n  function closeModal() {\n    setModalOpen(false);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"FileUpload\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: onSubmit,\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"filled submit-button\",\n          type: \"submit\",\n          children: /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n            icon: faUpload\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 104,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"file-upload\",\n          children: \"Choose file...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"file-upload\",\n          type: \"file\",\n          onChange: onChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 17\n      }, this), allFiles && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"item-list\",\n        children: allFiles.map((element, i) => {\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"item\",\n            title: element.Nom,\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              onClick: () => openModal(element),\n              children: /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n                icon: faTrash\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 113,\n                columnNumber: 71\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 113,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n              onClick: () => openFile(element.Nom),\n              src: pdf,\n              alt: \"icon pdf\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 114,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              onClick: () => openFile(element.Nom),\n              children: element.Nom\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 115,\n              columnNumber: 33\n            }, this)]\n          }, i, true, {\n            fileName: _jsxFileName,\n            lineNumber: 112,\n            columnNumber: 37\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(ModalConfirmation, {\n      title: \"Warning\",\n      message: message,\n      open: modalOpen,\n      close: closeModal,\n      mainAction: deleteFile,\n      mainActionParameters: selectedElement,\n      mainActionName: \"Delete\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 100,\n    columnNumber: 9\n  }, this);\n}\n\n_s(FileUpload, \"rs5569t3NHTciekp3nmjKeLUIf8=\");\n\n_c = FileUpload;\nexport default FileUpload;\n\nvar _c;\n\n$RefreshReg$(_c, \"FileUpload\");","map":{"version":3,"sources":["C:/wamp64/www/Projet_TER/src/views/FileUpload.js"],"names":["React","useEffect","useState","$","axios","FontAwesomeIcon","faUpload","faTrash","ModalConfirmation","FileUpload","props","file","setFile","allFiles","setAllFiles","onSubmit","e","preventDefault","uploadFile","onChange","target","files","formData","FormData","append","protocol","window","location","host","hostname","url","post","headers","then","response","loadFiles","openFile","name","open","deleteFile","id","data","JSON","stringify","Number","console","log","method","get","ressources","html","css","modalOpen","setModalOpen","message","setMessage","selectedElement","setSelectedElement","openModal","element","Nom","ID_Ressource","closeModal","map","i","pdf"],"mappings":";;;AAAA,OAAOA,KAAP,IAAeC,SAAf,EAA0BC,QAA1B,QAAyC,OAAzC;AACA,OAAOC,CAAP,MAAc,QAAd;AACA,OAAOC,KAAP,MAAkB,OAAlB;;AAEA,SAASC,eAAT,QAAgC,gCAAhC;AACA,SAASC,QAAT,EAAmBC,OAAnB,QAAkC,mCAAlC;AACA,OAAOC,iBAAP,MAA8B,uCAA9B;;;AAEA,SAASC,UAAT,CAAoBC,KAApB,EAA2B;AAAA;;AACvB,QAAM,CAACC,IAAD,EAAOC,OAAP,IAAkBV,QAAQ,CAAC,IAAD,CAAhC;AACA,QAAM,CAACW,QAAD,EAAWC,WAAX,IAA0BZ,QAAQ,CAAC,IAAD,CAAxC;;AAEA,WAASa,QAAT,CAAkBC,CAAlB,EAAqB;AACjBA,IAAAA,CAAC,CAACC,cAAF;AACAC,IAAAA,UAAU,CAACP,IAAD,CAAV;AACH;;AAED,WAASQ,QAAT,CAAkBH,CAAlB,EAAqB;AACjBJ,IAAAA,OAAO,CAACI,CAAC,CAACI,MAAF,CAASC,KAAT,CAAe,CAAf,CAAD,CAAP;AACH;;AAED,WAASH,UAAT,CAAoBP,IAApB,EAA0B;AACtB,UAAMW,QAAQ,GAAG,IAAIC,QAAJ,EAAjB;AACAD,IAAAA,QAAQ,CAACE,MAAT,CAAgB,MAAhB,EAAwBb,IAAxB;AACA,QAAIc,QAAQ,GAAGC,MAAM,CAACC,QAAP,CAAgBF,QAA/B;AACA,QAAIG,IAAI,GAAGF,MAAM,CAACC,QAAP,CAAgBE,QAA3B;AACA,QAAIC,GAAG,GAAGL,QAAQ,GAAG,IAAX,GAAkBG,IAA5B;AACAxB,IAAAA,KAAK,CAAC2B,IAAN,CAAWD,GAAG,GAAG,sDAAjB,EAAyER,QAAzE,EAAmF;AAC/EU,MAAAA,OAAO,EAAE;AACL,wBAAgB;AADX;AADsE,KAAnF,EAIGC,IAJH,CAIQC,QAAQ,IAAG;AACfC,MAAAA,SAAS;AACTvB,MAAAA,OAAO,CAAC,IAAD,CAAP;AACH,KAPD;AAQH;;AAED,WAASwB,QAAT,CAAkBC,IAAlB,EAAuB;AACnB,QAAIZ,QAAQ,GAAGC,MAAM,CAACC,QAAP,CAAgBF,QAA/B;AACA,QAAIG,IAAI,GAAGF,MAAM,CAACC,QAAP,CAAgBE,QAA3B;AACA,QAAIC,GAAG,GAAGL,QAAQ,GAAG,IAAX,GAAkBG,IAA5B;AACAF,IAAAA,MAAM,CAACY,IAAP,CAAYR,GAAG,GAAG,6CAAN,GAAsDO,IAAlE;AACH;;AAED,WAASE,UAAT,CAAoBC,EAApB,EAAuB;AACnB,QAAIf,QAAQ,GAAGC,MAAM,CAACC,QAAP,CAAgBF,QAA/B;AACA,QAAIG,IAAI,GAAGF,MAAM,CAACC,QAAP,CAAgBE,QAA3B;AACA,QAAIC,GAAG,GAAGL,QAAQ,GAAG,IAAX,GAAkBG,IAA5B;AACA,QAAIa,IAAI,GAAGC,IAAI,CAACC,SAAL,CAAe;AAACH,MAAAA,EAAE,EAAEI,MAAM,CAACJ,EAAD;AAAX,KAAf,CAAX;AACAK,IAAAA,OAAO,CAACC,GAAR,CAAYL,IAAZ;AACArC,IAAAA,KAAK,CAAC;AACF2C,MAAAA,MAAM,EAAE,QADN;AAEFjB,MAAAA,GAAG,EAAEA,GAAG,GAAE,8DAFR;AAGFW,MAAAA,IAAI,EAAEA;AAHJ,KAAD,CAAL,CAIGR,IAJH,CAIQC,QAAQ,IAAIC,SAAS,EAJ7B;AAKH;;AAED,WAASA,SAAT,GAAoB;AAChB,QAAIV,QAAQ,GAAGC,MAAM,CAACC,QAAP,CAAgBF,QAA/B;AACA,QAAIG,IAAI,GAAGF,MAAM,CAACC,QAAP,CAAgBE,QAA3B;AACA,QAAIC,GAAG,GAAGL,QAAQ,GAAG,IAAX,GAAkBG,IAA5B;AACAxB,IAAAA,KAAK,CAAC4C,GAAN,CAAUlB,GAAG,GAAG,gDAAhB,EACCG,IADD,CACMC,QAAQ,IAAG;AACbpB,MAAAA,WAAW,CAACoB,QAAQ,CAACO,IAAT,CAAcQ,UAAf,CAAX;AACH,KAHD;AAIH;;AAEDhD,EAAAA,SAAS,CAAC,MAAM;AACZ,QAAGU,IAAH,EAAQ;AACJR,MAAAA,CAAC,CAAC,YAAD,CAAD,CAAgB+C,IAAhB,CAAqBvC,IAAI,CAAC0B,IAA1B;AACAlC,MAAAA,CAAC,CAAC,YAAD,CAAD,CAAgBgD,GAAhB,CAAoB,OAApB,EAA6B,OAA7B;AACH,KAHD,MAGO;AACHhD,MAAAA,CAAC,CAAC,YAAD,CAAD,CAAgB+C,IAAhB,CAAqB,gBAArB;AACA/C,MAAAA,CAAC,CAAC,YAAD,CAAD,CAAgBgD,GAAhB,CAAoB,OAApB,EAA6B,WAA7B;AACH;AACJ,GARQ,EAQN,CAACxC,IAAD,CARM,CAAT;AAUAV,EAAAA,SAAS,CAAC,MAAM;AACZ,QAAG,CAACY,QAAJ,EAAa;AACTsB,MAAAA,SAAS;AACZ;AACJ,GAJQ,EAIN,EAJM,CAAT,CArEuB,CA2EvB;;AACA,QAAM,CAACiB,SAAD,EAAYC,YAAZ,IAA4BnD,QAAQ,CAAC,KAAD,CAA1C;AACA,QAAM,CAACoD,OAAD,EAAUC,UAAV,IAAwBrD,QAAQ,CAAC,IAAD,CAAtC;AACA,QAAM,CAACsD,eAAD,EAAkBC,kBAAlB,IAAwCvD,QAAQ,CAAC,IAAD,CAAtD;;AAEA,WAASwD,SAAT,CAAmBC,OAAnB,EAA4B;AACxBN,IAAAA,YAAY,CAAC,IAAD,CAAZ;AACAE,IAAAA,UAAU,CAAC,2BAA2BI,OAAO,CAACC,GAAnC,GAAyC,IAA1C,CAAV;AACAH,IAAAA,kBAAkB,CAACE,OAAO,CAACE,YAAT,CAAlB;AACH;;AAED,WAASC,UAAT,GAAqB;AACjBT,IAAAA,YAAY,CAAC,KAAD,CAAZ;AACH;;AAED,sBACI;AAAK,IAAA,SAAS,EAAC,YAAf;AAAA,4BACI;AAAA,8BACI;AAAM,QAAA,QAAQ,EAAEtC,QAAhB;AAAA,gCACI;AAAQ,UAAA,SAAS,EAAC,sBAAlB;AAAyC,UAAA,IAAI,EAAC,QAA9C;AAAA,iCACI,QAAC,eAAD;AAAiB,YAAA,IAAI,EAAET;AAAvB;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,gBADJ,eAII;AAAO,UAAA,OAAO,EAAC,aAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAJJ,eAKI;AAAO,UAAA,EAAE,EAAC,aAAV;AAAwB,UAAA,IAAI,EAAC,MAA7B;AAAoC,UAAA,QAAQ,EAAEa;AAA9C;AAAA;AAAA;AAAA;AAAA,gBALJ;AAAA;AAAA;AAAA;AAAA;AAAA,cADJ,EAQKN,QAAQ,iBACL;AAAK,QAAA,SAAS,EAAC,WAAf;AAAA,kBACKA,QAAQ,CAACkD,GAAT,CAAa,CAACJ,OAAD,EAAUK,CAAV,KAAgB;AAC1B,8BAAQ;AAAK,YAAA,SAAS,EAAC,MAAf;AAAsB,YAAA,KAAK,EAAEL,OAAO,CAACC,GAArC;AAAA,oCACJ;AAAG,cAAA,OAAO,EAAE,MAAMF,SAAS,CAACC,OAAD,CAA3B;AAAA,qCAAsC,QAAC,eAAD;AAAiB,gBAAA,IAAI,EAAEpD;AAAvB;AAAA;AAAA;AAAA;AAAA;AAAtC;AAAA;AAAA;AAAA;AAAA,oBADI,eAEJ;AAAK,cAAA,OAAO,EAAE,MAAM6B,QAAQ,CAACuB,OAAO,CAACC,GAAT,CAA5B;AAA2C,cAAA,GAAG,EAAEK,GAAhD;AAAqD,cAAA,GAAG,EAAC;AAAzD;AAAA;AAAA;AAAA;AAAA,oBAFI,eAGJ;AAAG,cAAA,OAAO,EAAE,MAAM7B,QAAQ,CAACuB,OAAO,CAACC,GAAT,CAA1B;AAAA,wBAA0CD,OAAO,CAACC;AAAlD;AAAA;AAAA;AAAA;AAAA,oBAHI;AAAA,aAA+CI,CAA/C;AAAA;AAAA;AAAA;AAAA,kBAAR;AAOH,SARA;AADL;AAAA;AAAA;AAAA;AAAA,cATR;AAAA;AAAA;AAAA;AAAA;AAAA,YADJ,eAwBI,QAAC,iBAAD;AACI,MAAA,KAAK,EAAC,SADV;AAEI,MAAA,OAAO,EAAEV,OAFb;AAGI,MAAA,IAAI,EAAEF,SAHV;AAII,MAAA,KAAK,EAAEU,UAJX;AAKI,MAAA,UAAU,EAAEvB,UALhB;AAMI,MAAA,oBAAoB,EAAEiB,eAN1B;AAOI,MAAA,cAAc,EAAC;AAPnB;AAAA;AAAA;AAAA;AAAA,YAxBJ;AAAA;AAAA;AAAA;AAAA;AAAA,UADJ;AAqCH;;GA/HQ/C,U;;KAAAA,U;AAiIT,eAAeA,UAAf","sourcesContent":["import React, {useEffect, useState} from \"react\";\r\nimport $ from 'jquery';\r\nimport axios from 'axios';\r\nimport pdf from '../public/pdf.svg'\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { faUpload, faTrash } from '@fortawesome/free-solid-svg-icons';\r\nimport ModalConfirmation from '../components/modal/ModalConfirmation';\r\n\r\nfunction FileUpload(props) {\r\n    const [file, setFile] = useState(null);\r\n    const [allFiles, setAllFiles] = useState(null);\r\n\r\n    function onSubmit(e) {\r\n        e.preventDefault()\r\n        uploadFile(file);\r\n    }\r\n\r\n    function onChange(e) {\r\n        setFile(e.target.files[0]);\r\n    }\r\n\r\n    function uploadFile(file) {\r\n        const formData = new FormData();\r\n        formData.append('file', file);\r\n        let protocol = window.location.protocol;\r\n        let host = window.location.hostname;\r\n        let url = protocol + '//' + host;\r\n        axios.post(url + '/Projet_TER/API/Controllers/ressource/uploadFile.php', formData, {\r\n            headers: {\r\n                'content-type': 'multipart/form-data'\r\n            }\r\n        }).then(response =>{\r\n            loadFiles();\r\n            setFile(null);\r\n        });\r\n    }\r\n\r\n    function openFile(name){\r\n        let protocol = window.location.protocol;\r\n        let host = window.location.hostname;\r\n        let url = protocol + '//' + host;\r\n        window.open(url + '/Projet_TER/src/public/documentsRessources/' + name);\r\n    }\r\n\r\n    function deleteFile(id){\r\n        let protocol = window.location.protocol;\r\n        let host = window.location.hostname;\r\n        let url = protocol + '//' + host;\r\n        let data = JSON.stringify({id: Number(id)});\r\n        console.log(data);\r\n        axios({\r\n            method: 'delete',\r\n            url: url+ '/Projet_TER/API/Controllers/ressource/supprimerRessource.php',\r\n            data: data\r\n        }).then(response => loadFiles())\r\n    }\r\n\r\n    function loadFiles(){\r\n        let protocol = window.location.protocol;\r\n        let host = window.location.hostname;\r\n        let url = protocol + '//' + host;\r\n        axios.get(url + '/Projet_TER/API/Controllers/ressource/lire.php')\r\n        .then(response =>{\r\n            setAllFiles(response.data.ressources)\r\n        });\r\n    }\r\n\r\n    useEffect(() => {\r\n        if(file){\r\n            $(\"form>label\").html(file.name);\r\n            $(\"form>label\").css(\"color\", \"black\");\r\n        } else {\r\n            $(\"form>label\").html(\"Choose file...\");\r\n            $(\"form>label\").css(\"color\", \"lightgray\");\r\n        }\r\n    }, [file]);\r\n\r\n    useEffect(() => {\r\n        if(!allFiles){\r\n            loadFiles();\r\n        }\r\n    }, []);\r\n\r\n    // Modal management\r\n    const [modalOpen, setModalOpen] = useState(false);\r\n    const [message, setMessage] = useState(null);\r\n    const [selectedElement, setSelectedElement] = useState(null);\r\n\r\n    function openModal(element) {\r\n        setModalOpen(true);\r\n        setMessage(\"Do you want to delete \" + element.Nom + \" ?\")\r\n        setSelectedElement(element.ID_Ressource)\r\n    }\r\n\r\n    function closeModal(){\r\n        setModalOpen(false);\r\n    }\r\n\r\n    return (\r\n        <div className=\"FileUpload\">\r\n            <div>\r\n                <form onSubmit={onSubmit}>\r\n                    <button className=\"filled submit-button\" type=\"submit\">                        \r\n                        <FontAwesomeIcon icon={faUpload} />\r\n                    </button>\r\n                    <label htmlFor=\"file-upload\">Choose file...</label>\r\n                    <input id=\"file-upload\" type=\"file\" onChange={onChange}/>\r\n                </form>        \r\n                {allFiles &&\r\n                    <div className=\"item-list\">\r\n                        {allFiles.map((element, i) => {   \r\n                            return (<div className=\"item\" title={element.Nom} key={i}>\r\n                                <p onClick={() => openModal(element)}><FontAwesomeIcon icon={faTrash} /></p>\r\n                                <img onClick={() => openFile(element.Nom)} src={pdf} alt=\"icon pdf\"/>\r\n                                <p onClick={() => openFile(element.Nom)}>{element.Nom}</p>\r\n                                </div>\r\n                            ) \r\n                            \r\n                        })}    \r\n                    </div>\r\n                }  \r\n            </div>\r\n\r\n            <ModalConfirmation\r\n                title=\"Warning\"\r\n                message={message}\r\n                open={modalOpen}  \r\n                close={closeModal}\r\n                mainAction={deleteFile}\r\n                mainActionParameters={selectedElement}\r\n                mainActionName=\"Delete\"\r\n            />\r\n\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default FileUpload;\r\n"]},"metadata":{},"sourceType":"module"}