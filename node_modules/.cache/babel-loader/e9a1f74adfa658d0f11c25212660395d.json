{"ast":null,"code":"import _regeneratorRuntime from\"C:/wamp64/www/Projet_TER/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/wamp64/www/Projet_TER/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"C:/wamp64/www/Projet_TER/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"C:/wamp64/www/Projet_TER/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:/wamp64/www/Projet_TER/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useContext,useState}from'react';import Auth from\"../contexts/Auth\";import{login,isUser}from\"../services/AuthApi\";import'font-awesome/css/font-awesome.min.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Login=function Login(props){//Utilisation du contexte pour vérifier les états de connexion\nvar _useContext=useContext(Auth),setIsAuthenticated=_useContext.setIsAuthenticated,setUserRole=_useContext.setUserRole;var _useState=useState({username:\"\",mot_de_passe:\"\"}),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var handleChange=function handleChange(_ref){var currentTarget=_ref.currentTarget;var name=currentTarget.name,value=currentTarget.value;setUser(_objectSpread(_objectSpread({},user),{},_defineProperty({},name,value)));};var handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var response,userRole,_response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();//Set les états du contexte quand on est connecté\n_context.prev=1;_context.next=4;return login(user);case 4:response=_context.sent;if(response===false){props.history.push({pathname:'/login',state:{error:\"Error, please check your username and your password.\"}});}else{setIsAuthenticated(response);userRole=isUser();if(userRole){setUserRole(userRole);}props.history.push('/quiz');}_context.next=12;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](1);_response=_context.t0.response;console.log(_response);case 12:case\"end\":return _context.stop();}}},_callee,null,[[1,8]]);}));return function handleSubmit(_x){return _ref2.apply(this,arguments);};}();var change=function change(){props.history.push('/register');};// useEffect(() => {\n//    // Redirection si déjà loggé et sur la page login\n//     if (isAuthenticated) {\n//         history.replace('/home')\n//     }\n//\n// }, [history, isAuthenticated]);\nreturn/*#__PURE__*/_jsx(\"div\",{className:\"LoginRegister\",children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Sign in\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"InputItems\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"input\",{className:\"inputIcon\",type:\"text\",id:\"username\",name:\"username\",required:true,placeholder:\"\\uF007    Username\",onChange:handleChange})}),/*#__PURE__*/_jsx(\"div\",{children:props.location.state?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"input\",{className:\"ErrorInput\",type:\"password\",id:\"password\",name:\"mot_de_passe\",required:true,placeholder:\"    Password\",onChange:handleChange}),/*#__PURE__*/_jsx(\"div\",{className:\"ErrorMessage\",children:props.location.state.error})]}):/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"input\",{className:\"inputIcon\",type:\"password\",id:\"password\",name:\"mot_de_passe\",required:true,placeholder:\"    Password\",onChange:handleChange})})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"action\",children:/*#__PURE__*/_jsx(\"button\",{className:\"button filled\",onClick:handleSubmit,children:\"Sign in\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"signup\",children:/*#__PURE__*/_jsxs(\"p\",{children:[\"Don't have an account ?\",/*#__PURE__*/_jsx(\"button\",{className:\"link-button\",onClick:change,children:\"Create one now\"})]})})]})});};export default Login;","map":{"version":3,"sources":["C:/wamp64/www/Projet_TER/src/views/Login.js"],"names":["React","useContext","useState","Auth","login","isUser","Login","props","setIsAuthenticated","setUserRole","username","mot_de_passe","user","setUser","handleChange","currentTarget","name","value","handleSubmit","event","preventDefault","response","history","push","pathname","state","error","userRole","console","log","change","location"],"mappings":"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","sourcesContent":["import React, {useContext, useState} from 'react';\r\nimport Auth from \"../contexts/Auth\";\r\nimport {login, isUser} from \"../services/AuthApi\";\r\nimport 'font-awesome/css/font-awesome.min.css';\r\n\r\nconst Login = (props) => {\r\n\r\n    //Utilisation du contexte pour vérifier les états de connexion\r\n    const {setIsAuthenticated, setUserRole} = useContext(Auth);\r\n\r\n    const [user, setUser] = useState({\r\n        username: \"\",\r\n        mot_de_passe: \"\"\r\n    });\r\n\r\n    const handleChange = ({currentTarget}) => {\r\n        const {name, value} = currentTarget;\r\n        setUser({...user, [name]: value})\r\n    }\r\n\r\n    const handleSubmit = async event => {\r\n        event.preventDefault();\r\n\r\n        //Set les états du contexte quand on est connecté\r\n        try {\r\n            const response = await login(user);\r\n            if (response === false) {\r\n                props.history.push({\r\n                    pathname: '/login',\r\n                    state: {error: \"Error, please check your username and your password.\"}\r\n                })\r\n            } else {\r\n                setIsAuthenticated(response);\r\n                let userRole = isUser();\r\n                if (userRole) {\r\n                    setUserRole(userRole)\r\n                }\r\n                props.history.push('/quiz')\r\n            }\r\n\r\n        } catch ({response}) {\r\n            console.log(response);\r\n        }\r\n    }\r\n\r\n    const change = () => {\r\n        props.history.push('/register')\r\n    }\r\n\r\n    // useEffect(() => {\r\n    //    // Redirection si déjà loggé et sur la page login\r\n    //     if (isAuthenticated) {\r\n    //         history.replace('/home')\r\n    //     }\r\n    //\r\n    // }, [history, isAuthenticated]);\r\n\r\n\r\n    return (\r\n        <div className=\"LoginRegister\">\r\n            <div>\r\n                <h3>Sign in</h3>\r\n                <div className=\"InputItems\">\r\n                    <div>\r\n                        <input className=\"inputIcon\" type=\"text\" id=\"username\" name=\"username\" required\r\n                               placeholder=\"    Username\"\r\n                               onChange={handleChange}/>\r\n                    </div>\r\n\r\n                    <div>\r\n\r\n                        {props.location.state ? <>\r\n                                <input className=\"ErrorInput\" type=\"password\" id=\"password\" name=\"mot_de_passe\" required\r\n                                       placeholder={\"    Password\"}\r\n                                       onChange={handleChange}/>\r\n                                <div className={\"ErrorMessage\"}>{props.location.state.error}</div>\r\n                            </> :\r\n                            <>\r\n                                <input className=\"inputIcon\" type=\"password\" id=\"password\" name=\"mot_de_passe\" required\r\n                                       placeholder={\"    Password\"}\r\n                                       onChange={handleChange}/>\r\n                            </>}\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"action\">\r\n                    <button className=\"button filled\" onClick={handleSubmit}>Sign in</button>\r\n                </div>\r\n\r\n                <div className=\"signup\">\r\n                    <p>Don't have an account ?\r\n                        <button\r\n                            className=\"link-button\"\r\n                            onClick={change}\r\n                        >\r\n                            Create one now\r\n                        </button>\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Login;\r\n"]},"metadata":{},"sourceType":"module"}